Layer (type)                 Output Shape              Param #   
=================================================================
conv1d_1 (Conv1D)            (None, 3750, 128)         12928     
_________________________________________________________________
conv1d_2 (Conv1D)            (None, 3750, 128)         327808    
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 187, 128)          0         
_________________________________________________________________
conv1d_3 (Conv1D)            (None, 187, 256)          655616    
_________________________________________________________________
global_max_pooling1d_1 (Glob (None, 256)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 1028      
=================================================================
Total params: 997,380
Trainable params: 997,380
Non-trainable params: 0
_________________________________________________________________

Loading EDF files from /media/sasi/WD500/hypno/cesga/SHHS-250
Dataset: train
shhs2-204889
shhs2-204937
shhs2-204938
shhs2-204956
shhs2-204963
shhs2-204970
shhs2-204987
shhs2-203106
shhs2-203112
shhs2-203131
shhs2-203132
shhs2-203143
shhs2-203149
shhs2-203156
shhs2-203160
shhs2-203161
shhs2-203183
shhs2-203198
shhs2-204016
shhs2-204039
shhs2-204057
shhs2-204075
shhs2-204076
shhs2-204081
shhs2-204082
shhs2-204083
shhs2-204089
shhs2-204097
shhs2-204115
shhs2-204156
shhs2-200712
shhs2-200731
shhs2-200796
shhs2-200801
shhs2-200828
shhs2-200836
shhs2-200842
shhs2-200878
shhs2-200888
shhs2-200906
shhs2-201482
shhs2-201487
shhs2-201532
shhs2-201600
shhs2-201604
shhs2-201622
shhs2-201634
shhs2-201651
shhs2-201659
shhs2-205288
shhs2-205308
shhs2-205345
shhs2-205436
shhs2-205524
shhs2-205528
shhs2-205565
shhs2-205590
shhs2-205636
shhs2-205650
shhs2-205673
shhs2-205737
shhs2-205738
shhs2-205753
shhs2-205796
shhs2-202524
shhs2-202539
shhs2-202565
shhs2-202773
shhs2-202912
shhs2-202927
shhs2-202939
shhs2-202945
shhs2-202979
shhs2-202995
shhs2-203006
shhs2-203016
shhs2-203019
shhs2-203042
shhs2-203054
shhs2-204604
shhs2-204616
shhs2-204642
shhs2-204647
shhs2-204686
shhs2-204692
shhs2-204698
shhs2-204713
shhs2-204718
shhs2-204735
shhs2-204752
shhs2-204755
shhs2-204799
shhs2-204821
shhs2-203218
shhs2-203219
shhs2-203368
shhs2-203414
shhs2-203442
shhs2-203448
shhs2-203499
shhs2-203510
shhs2-203519
shhs2-203559
shhs2-203562
shhs2-203566
shhs2-203586
shhs2-204236
shhs2-204240
shhs2-204248
shhs2-204253
shhs2-204285
shhs2-204306
shhs2-204314
shhs2-204324
shhs2-204339
shhs2-204368
shhs2-204373
shhs2-200352
shhs2-200361
shhs2-200410
shhs2-200467
shhs2-200566
shhs2-200572
shhs2-200576
shhs2-200602
shhs2-200620
shhs2-203849
shhs2-203865
shhs2-203882
shhs2-203896
shhs2-203897
shhs2-203900
shhs2-203902
shhs2-203931
shhs2-203938
shhs2-203941
shhs2-203956
shhs2-203984
shhs2-204006
shhs2-205032
shhs2-205044
shhs2-205071
shhs2-205145
shhs2-205186
shhs2-205194
shhs2-205212
shhs2-205231
shhs2-205240
shhs2-201328
shhs2-201366
shhs2-201373
shhs2-201377
shhs2-201401
shhs2-201402
shhs2-201409
shhs2-201439
shhs2-200955
shhs2-200959
shhs2-201032
shhs2-201034
shhs2-201064
shhs2-201066
shhs2-201069
shhs2-201083
shhs2-201687
shhs2-201691
shhs2-201695
shhs2-201696
shhs2-201698
shhs2-201779
shhs2-201832
shhs2-201877
shhs2-204445
shhs2-204478
shhs2-204496
shhs2-204497
shhs2-204555
shhs2-204569
shhs2-204576
shhs2-204578
Dataset: validation
shhs2-201477
shhs2-201878
shhs2-203083
shhs2-203213
shhs2-203614
shhs2-203818
shhs2-204014
shhs2-204377
shhs2-204585
shhs2-204835
shhs2-205271
shhs2-201132
shhs2-201192
shhs2-201211
shhs2-201232
shhs2-201267
shhs2-201277
shhs2-201282
shhs2-201304
shhs2-204886
Dataset: test
shhs2-200089
shhs2-200133
shhs2-200136
shhs2-200145
shhs2-200168
shhs2-200175
shhs2-200182
shhs2-200191
shhs2-200192
shhs2-200194
shhs2-203637
shhs2-203650
shhs2-203652
shhs2-203657
shhs2-203704
shhs2-203708
shhs2-203711
shhs2-203766
shhs2-203773
shhs2-203795
shhs2-201897
shhs2-201933
shhs2-201988
shhs2-202015
shhs2-202442
shhs2-202463
shhs2-202465
shhs2-202483
shhs2-202512
shhs2-204386
shhs2-204387
shhs2-204391
shhs2-204417
shhs2-204421
shhs2-204430
shhs2-200313
shhs2-200700
shhs2-200939
shhs2-201118
shhs2-201326
2017-11-14 17:56:15.252484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 780 Ti, pci bus id: 0000:01:00.0)
Using 5 models
File 0: shhs2-200089 [0]
[[307   8   0   2]
 [ 15 437   6  28]
 [  0  13 122   0]
 [  3  10   0 222]]
[[ 0.96845426  0.02523659  0.          0.00630915]
 [ 0.0308642   0.89917695  0.01234568  0.05761317]
 [ 0.          0.0962963   0.9037037   0.        ]
 [ 0.01276596  0.04255319  0.          0.94468085]]
             precision    recall  f1-score   support

          W       0.94      0.97      0.96       317
       N1-2       0.93      0.90      0.92       486
         N3       0.95      0.90      0.93       135
        REM       0.88      0.94      0.91       235

avg / total       0.93      0.93      0.93      1173

File 1: shhs2-200133 [1]
[[543   8   0   5]
 [  1 474  11   3]
 [  0   4 120   0]
 [  1   8   0 142]]
[[ 0.97661871  0.01438849  0.          0.00899281]
 [ 0.00204499  0.96932515  0.02249489  0.00613497]
 [ 0.          0.03225806  0.96774194  0.        ]
 [ 0.00662252  0.05298013  0.          0.94039735]]
             precision    recall  f1-score   support

          W       1.00      0.98      0.99       556
       N1-2       0.96      0.97      0.96       489
         N3       0.92      0.97      0.94       124
        REM       0.95      0.94      0.94       151

avg / total       0.97      0.97      0.97      1320

File 2: shhs2-200136 [2]
[[609  13   0   5]
 [196 392  11   9]
 [  1  16  19   0]
 [ 28   5   0  59]]
[[ 0.97129187  0.02073365  0.          0.00797448]
 [ 0.32236842  0.64473684  0.01809211  0.01480263]
 [ 0.02777778  0.44444444  0.52777778  0.        ]
 [ 0.30434783  0.05434783  0.          0.64130435]]
             precision    recall  f1-score   support

          W       0.73      0.97      0.83       627
       N1-2       0.92      0.64      0.76       608
         N3       0.63      0.53      0.58        36
        REM       0.81      0.64      0.72        92

avg / total       0.82      0.79      0.79      1363

File 3: shhs2-200145 [3]
[[596  18   0   5]
 [ 18 409   6  34]
 [  0  21  70   0]
 [  1   2   0 200]]
[[ 0.9628433   0.02907916  0.          0.00807754]
 [ 0.0385439   0.875803    0.01284797  0.07280514]
 [ 0.          0.23076923  0.76923077  0.        ]
 [ 0.00492611  0.00985222  0.          0.98522167]]
             precision    recall  f1-score   support

          W       0.97      0.96      0.97       619
       N1-2       0.91      0.88      0.89       467
         N3       0.92      0.77      0.84        91
        REM       0.84      0.99      0.90       203

avg / total       0.93      0.92      0.92      1380

File 4: shhs2-200168 [4]
[[680   1   0   0]
 [ 15 402   6  23]
 [  0  83 171   0]
 [  3   3   0 165]]
[[ 0.99853157  0.00146843  0.          0.        ]
 [ 0.03363229  0.90134529  0.01345291  0.05156951]
 [ 0.          0.32677165  0.67322835  0.        ]
 [ 0.01754386  0.01754386  0.          0.96491228]]
             precision    recall  f1-score   support

          W       0.97      1.00      0.99       681
       N1-2       0.82      0.90      0.86       446
         N3       0.97      0.67      0.79       254
        REM       0.88      0.96      0.92       171

avg / total       0.92      0.91      0.91      1552

File 5: shhs2-200175 [5]
[[633  24   1   1]
 [ 18 425  59   5]
 [  0  23 127   0]
 [ 34  31   0 102]]
[[ 0.96054628  0.03641882  0.00151745  0.00151745]
 [ 0.03550296  0.8382643   0.11637081  0.00986193]
 [ 0.          0.15333333  0.84666667  0.        ]
 [ 0.20359281  0.18562874  0.          0.61077844]]
             precision    recall  f1-score   support

          W       0.92      0.96      0.94       659
       N1-2       0.84      0.84      0.84       507
         N3       0.68      0.85      0.75       150
        REM       0.94      0.61      0.74       167

avg / total       0.87      0.87      0.87      1483

File 6: shhs2-200182 [6]
[[745   2   0   3]
 [ 36 302   0  46]
 [  0   9   1   0]
 [  1   0   0 172]]
[[ 0.99333333  0.00266667  0.          0.004     ]
 [ 0.09375     0.78645833  0.          0.11979167]
 [ 0.          0.9         0.1         0.        ]
 [ 0.00578035  0.          0.          0.99421965]]
             precision    recall  f1-score   support

          W       0.95      0.99      0.97       750
       N1-2       0.96      0.79      0.87       384
         N3       1.00      0.10      0.18        10
        REM       0.78      0.99      0.87       173

avg / total       0.93      0.93      0.92      1317

File 7: shhs2-200191 [7]
[[849  11   0   0]
 [  8 136   8   1]
 [  0  24 176   0]
 [  1  10   0  92]]
[[ 0.9872093   0.0127907   0.          0.        ]
 [ 0.05228758  0.88888889  0.05228758  0.00653595]
 [ 0.          0.12        0.88        0.        ]
 [ 0.00970874  0.09708738  0.          0.89320388]]
             precision    recall  f1-score   support

          W       0.99      0.99      0.99       860
       N1-2       0.75      0.89      0.81       153
         N3       0.96      0.88      0.92       200
        REM       0.99      0.89      0.94       103

avg / total       0.96      0.95      0.95      1316

File 8: shhs2-200192 [8]
[[812  28   0   3]
 [  1 449   3   1]
 [  0   3   5   0]
 [  1   5   0   3]]
[[ 0.96322657  0.03321471  0.          0.00355872]
 [ 0.00220264  0.98898678  0.00660793  0.00220264]
 [ 0.          0.375       0.625       0.        ]
 [ 0.11111111  0.55555556  0.          0.33333333]]
             precision    recall  f1-score   support

          W       1.00      0.96      0.98       843
       N1-2       0.93      0.99      0.96       454
         N3       0.62      0.62      0.62         8
        REM       0.43      0.33      0.38         9

avg / total       0.97      0.97      0.97      1314

File 9: shhs2-200194 [9]
[[516   9   0  10]
 [  9 493   5  44]
 [  0  35  47   0]
 [  5   3   0 302]]
[[ 0.96448598  0.01682243  0.          0.01869159]
 [ 0.01633394  0.89473684  0.00907441  0.07985481]
 [ 0.          0.42682927  0.57317073  0.        ]
 [ 0.01612903  0.00967742  0.          0.97419355]]
             precision    recall  f1-score   support

          W       0.97      0.96      0.97       535
       N1-2       0.91      0.89      0.90       551
         N3       0.90      0.57      0.70        82
        REM       0.85      0.97      0.91       310

avg / total       0.92      0.92      0.92      1478

File 10: shhs2-203637 [10]
[[655   2   0   1]
 [ 40 241   6   5]
 [  0  32  40   0]
 [  9  14   0  95]]
[[ 0.99544073  0.00303951  0.          0.00151976]
 [ 0.1369863   0.82534247  0.02054795  0.01712329]
 [ 0.          0.44444444  0.55555556  0.        ]
 [ 0.07627119  0.11864407  0.          0.80508475]]
             precision    recall  f1-score   support

          W       0.93      1.00      0.96       658
       N1-2       0.83      0.83      0.83       292
         N3       0.87      0.56      0.68        72
        REM       0.94      0.81      0.87       118

avg / total       0.90      0.90      0.90      1140

File 11: shhs2-203650 [11]
[[481   7   0   5]
 [ 16 405   3  18]
 [  0  35  94   0]
 [  1   7   0 126]]
[[ 0.97565923  0.01419878  0.          0.01014199]
 [ 0.0361991   0.91628959  0.00678733  0.04072398]
 [ 0.          0.27131783  0.72868217  0.        ]
 [ 0.00746269  0.05223881  0.          0.94029851]]
             precision    recall  f1-score   support

          W       0.97      0.98      0.97       493
       N1-2       0.89      0.92      0.90       442
         N3       0.97      0.73      0.83       129
        REM       0.85      0.94      0.89       134

avg / total       0.93      0.92      0.92      1198

File 12: shhs2-203652 [12]
[[685   3   0   2]
 [  8 332   4  16]
 [  0   7 114   0]
 [  2   2   0 143]]
[[ 0.99275362  0.00434783  0.          0.00289855]
 [ 0.02222222  0.92222222  0.01111111  0.04444444]
 [ 0.          0.05785124  0.94214876  0.        ]
 [ 0.01360544  0.01360544  0.          0.97278912]]
             precision    recall  f1-score   support

          W       0.99      0.99      0.99       690
       N1-2       0.97      0.92      0.94       360
         N3       0.97      0.94      0.95       121
        REM       0.89      0.97      0.93       147

avg / total       0.97      0.97      0.97      1318

File 13: shhs2-203657 [13]
[[678  47   0   2]
 [  7 365   5   4]
 [  0  49  90   0]
 [  4   3   0  66]]
[[ 0.93259972  0.06464924  0.          0.00275103]
 [ 0.0183727   0.95800525  0.01312336  0.01049869]
 [ 0.          0.35251799  0.64748201  0.        ]
 [ 0.05479452  0.04109589  0.          0.90410959]]
             precision    recall  f1-score   support

          W       0.98      0.93      0.96       727
       N1-2       0.79      0.96      0.86       381
         N3       0.95      0.65      0.77       139
        REM       0.92      0.90      0.91        73

avg / total       0.92      0.91      0.91      1320

File 14: shhs2-203704 [15]
[[425   1   0   1]
 [  7 330  34  21]
 [  0  10 250   0]
 [  1   3   0 177]]
[[ 0.99531616  0.00234192  0.          0.00234192]
 [ 0.01785714  0.84183673  0.08673469  0.05357143]
 [ 0.          0.03846154  0.96153846  0.        ]
 [ 0.00552486  0.01657459  0.          0.97790055]]
             precision    recall  f1-score   support

          W       0.98      1.00      0.99       427
       N1-2       0.96      0.84      0.90       392
         N3       0.88      0.96      0.92       260
        REM       0.89      0.98      0.93       181

avg / total       0.94      0.94      0.94      1260

File 15: shhs2-203708 [16]
[[555  14   0  13]
 [  3 364  19  28]
 [  0  35 145   0]
 [  1   4   0 139]]
[[ 0.95360825  0.02405498  0.          0.02233677]
 [ 0.00724638  0.87922705  0.04589372  0.06763285]
 [ 0.          0.19444444  0.80555556  0.        ]
 [ 0.00694444  0.02777778  0.          0.96527778]]
             precision    recall  f1-score   support

          W       0.99      0.95      0.97       582
       N1-2       0.87      0.88      0.88       414
         N3       0.88      0.81      0.84       180
        REM       0.77      0.97      0.86       144

avg / total       0.92      0.91      0.91      1320

File 16: shhs2-203711 [17]
[[348   8   0   2]
 [  4 425  30  18]
 [  0   7 128   0]
 [  1   5   0 134]]
[[ 0.97206704  0.02234637  0.          0.00558659]
 [ 0.00838574  0.89098532  0.06289308  0.03773585]
 [ 0.          0.05185185  0.94814815  0.        ]
 [ 0.00714286  0.03571429  0.          0.95714286]]
             precision    recall  f1-score   support

          W       0.99      0.97      0.98       358
       N1-2       0.96      0.89      0.92       477
         N3       0.81      0.95      0.87       135
        REM       0.87      0.96      0.91       140

avg / total       0.94      0.93      0.93      1110

File 17: shhs2-203766 [18]
[[491   9   0   0]
 [ 41 587  13   1]
 [  0  17  69   0]
 [  2  22   0  68]]
[[ 0.982       0.018       0.          0.        ]
 [ 0.06386293  0.91433022  0.02024922  0.00155763]
 [ 0.          0.19767442  0.80232558  0.        ]
 [ 0.02173913  0.23913043  0.          0.73913043]]
             precision    recall  f1-score   support

          W       0.92      0.98      0.95       500
       N1-2       0.92      0.91      0.92       642
         N3       0.84      0.80      0.82        86
        REM       0.99      0.74      0.84        92

avg / total       0.92      0.92      0.92      1320

File 18: shhs2-203773 [19]
[[557   7   0   9]
 [  1 378  26  13]
 [  0  11 104   0]
 [  0   6   0 148]]
[[ 0.97207679  0.0122164   0.          0.01570681]
 [ 0.00239234  0.90430622  0.06220096  0.03110048]
 [ 0.          0.09565217  0.90434783  0.        ]
 [ 0.          0.03896104  0.          0.96103896]]
             precision    recall  f1-score   support

          W       1.00      0.97      0.98       573
       N1-2       0.94      0.90      0.92       418
         N3       0.80      0.90      0.85       115
        REM       0.87      0.96      0.91       154

avg / total       0.95      0.94      0.94      1260

File 19: shhs2-203795 [20]
[[369  58   0   1]
 [ 10 750   3  11]
 [  0   1   0   0]
 [  6   8   0 103]]
[[ 0.86214953  0.13551402  0.          0.00233645]
 [ 0.0129199   0.96899225  0.00387597  0.01421189]
 [ 0.          1.          0.          0.        ]
 [ 0.05128205  0.06837607  0.          0.88034188]]
             precision    recall  f1-score   support

          W       0.96      0.86      0.91       428
       N1-2       0.92      0.97      0.94       774
         N3       0.00      0.00      0.00         1
        REM       0.90      0.88      0.89       117

avg / total       0.93      0.93      0.93      1320

File 20: shhs2-201897 [22]
[[396  40   0   5]
 [  9 537   6   2]
 [  0  21  73   0]
 [  7  14   0  90]]
[[ 0.89795918  0.09070295  0.          0.01133787]
 [ 0.01624549  0.96931408  0.01083032  0.00361011]
 [ 0.          0.22340426  0.77659574  0.        ]
 [ 0.06306306  0.12612613  0.          0.81081081]]
             precision    recall  f1-score   support

          W       0.96      0.90      0.93       441
       N1-2       0.88      0.97      0.92       554
         N3       0.92      0.78      0.84        94
        REM       0.93      0.81      0.87       111

avg / total       0.92      0.91      0.91      1200

File 21: shhs2-201933 [24]
[[578  38   0   3]
 [  9 498   6   6]
 [  0  16  47   0]
 [  1   0   0 162]]
[[ 0.93376414  0.06138934  0.          0.00484653]
 [ 0.01734104  0.95953757  0.01156069  0.01156069]
 [ 0.          0.25396825  0.74603175  0.        ]
 [ 0.00613497  0.          0.          0.99386503]]
             precision    recall  f1-score   support

          W       0.98      0.93      0.96       619
       N1-2       0.90      0.96      0.93       519
         N3       0.89      0.75      0.81        63
        REM       0.95      0.99      0.97       163

avg / total       0.94      0.94      0.94      1364

File 22: shhs2-201988 [25]
[[381  13   0  16]
 [  1 378  31  18]
 [  0   9  32   0]
 [  2  11   0 190]]
[[ 0.92926829  0.03170732  0.          0.03902439]
 [ 0.00233645  0.88317757  0.07242991  0.04205607]
 [ 0.          0.2195122   0.7804878   0.        ]
 [ 0.00985222  0.05418719  0.          0.93596059]]
             precision    recall  f1-score   support

          W       0.99      0.93      0.96       410
       N1-2       0.92      0.88      0.90       428
         N3       0.51      0.78      0.62        41
        REM       0.85      0.94      0.89       203

avg / total       0.92      0.91      0.91      1082

File 23: shhs2-202015 [27]
[[441  11   0   1]
 [ 14 416  34   5]
 [  0  11 106   0]
 [  4  22   0  75]]
[[ 0.97350993  0.02428256  0.          0.00220751]
 [ 0.02985075  0.8869936   0.07249467  0.01066098]
 [ 0.          0.09401709  0.90598291  0.        ]
 [ 0.03960396  0.21782178  0.          0.74257426]]
             precision    recall  f1-score   support

          W       0.96      0.97      0.97       453
       N1-2       0.90      0.89      0.90       469
         N3       0.76      0.91      0.82       117
        REM       0.93      0.74      0.82       101

avg / total       0.91      0.91      0.91      1140

File 24: shhs2-202442 [32]
[[244   8   0   0]
 [ 25 380  12   6]
 [  0  12 210   0]
 [  6  21   0 156]]
[[ 0.96825397  0.03174603  0.          0.        ]
 [ 0.05910165  0.89834515  0.02836879  0.0141844 ]
 [ 0.          0.05405405  0.94594595  0.        ]
 [ 0.03278689  0.1147541   0.          0.85245902]]
             precision    recall  f1-score   support

          W       0.89      0.97      0.93       252
       N1-2       0.90      0.90      0.90       423
         N3       0.95      0.95      0.95       222
        REM       0.96      0.85      0.90       183

avg / total       0.92      0.92      0.92      1080

File 25: shhs2-202463 [33]
[[351  15   0   2]
 [  2 128   8   5]
 [  0  16 181   0]
 [  0  26   0 166]]
[[ 0.95380435  0.04076087  0.          0.00543478]
 [ 0.01398601  0.8951049   0.05594406  0.03496503]
 [ 0.          0.08121827  0.91878173  0.        ]
 [ 0.          0.13541667  0.          0.86458333]]
             precision    recall  f1-score   support

          W       0.99      0.95      0.97       368
       N1-2       0.69      0.90      0.78       143
         N3       0.96      0.92      0.94       197
        REM       0.96      0.86      0.91       192

avg / total       0.93      0.92      0.92       900

File 26: shhs2-202465 [34]
[[294  14   0   1]
 [ 19 672  19   8]
 [  0  27 104   0]
 [  3   6   0 123]]
[[ 0.95145631  0.04530744  0.          0.00323625]
 [ 0.0264624   0.93593315  0.0264624   0.01114206]
 [ 0.          0.20610687  0.79389313  0.        ]
 [ 0.02272727  0.04545455  0.          0.93181818]]
             precision    recall  f1-score   support

          W       0.93      0.95      0.94       309
       N1-2       0.93      0.94      0.94       718
         N3       0.85      0.79      0.82       131
        REM       0.93      0.93      0.93       132

avg / total       0.92      0.92      0.92      1290

File 27: shhs2-202483 [35]
[[488  34   0   4]
 [ 27 334   4   5]
 [  0  34  44   0]
 [  1   3   0  42]]
[[ 0.92775665  0.06463878  0.          0.00760456]
 [ 0.07297297  0.9027027   0.01081081  0.01351351]
 [ 0.          0.43589744  0.56410256  0.        ]
 [ 0.02173913  0.06521739  0.          0.91304348]]
             precision    recall  f1-score   support

          W       0.95      0.93      0.94       526
       N1-2       0.82      0.90      0.86       370
         N3       0.92      0.56      0.70        78
        REM       0.82      0.91      0.87        46

avg / total       0.89      0.89      0.89      1020

File 28: shhs2-202512 [36]
[[355  27   0   0]
 [  1 256   4   7]
 [  0   9 100   0]
 [  1  10   0  70]]
[[ 0.92931937  0.07068063  0.          0.        ]
 [ 0.00373134  0.95522388  0.01492537  0.0261194 ]
 [ 0.          0.08256881  0.91743119  0.        ]
 [ 0.01234568  0.12345679  0.          0.86419753]]
             precision    recall  f1-score   support

          W       0.99      0.93      0.96       382
       N1-2       0.85      0.96      0.90       268
         N3       0.96      0.92      0.94       109
        REM       0.91      0.86      0.89        81

avg / total       0.94      0.93      0.93       840

File 29: shhs2-204386 [37]
[[474  10   0   6]
 [ 12 344  18  15]
 [  0  12 263   0]
 [  0   6   0 158]]
[[ 0.96734694  0.02040816  0.          0.0122449 ]
 [ 0.03084833  0.88431877  0.04627249  0.03856041]
 [ 0.          0.04363636  0.95636364  0.        ]
 [ 0.          0.03658537  0.          0.96341463]]
             precision    recall  f1-score   support

          W       0.98      0.97      0.97       490
       N1-2       0.92      0.88      0.90       389
         N3       0.94      0.96      0.95       275
        REM       0.88      0.96      0.92       164

avg / total       0.94      0.94      0.94      1318

File 30: shhs2-204387 [38]
[[441   2   0   0]
 [ 39 486   0   6]
 [  0  22   1   0]
 [  7  18   0 100]]
[[ 0.99548533  0.00451467  0.          0.        ]
 [ 0.07344633  0.91525424  0.          0.01129944]
 [ 0.          0.95652174  0.04347826  0.        ]
 [ 0.056       0.144       0.          0.8       ]]
             precision    recall  f1-score   support

          W       0.91      1.00      0.95       443
       N1-2       0.92      0.92      0.92       531
         N3       1.00      0.04      0.08        23
        REM       0.94      0.80      0.87       125

avg / total       0.92      0.92      0.91      1122

File 31: shhs2-204391 [39]
[[574  56   0   0]
 [  2 465   6   0]
 [  0   8  12   0]
 [  0  20   0  57]]
[[ 0.91111111  0.08888889  0.          0.        ]
 [ 0.00422833  0.98308668  0.01268499  0.        ]
 [ 0.          0.4         0.6         0.        ]
 [ 0.          0.25974026  0.          0.74025974]]
             precision    recall  f1-score   support

          W       1.00      0.91      0.95       630
       N1-2       0.85      0.98      0.91       473
         N3       0.67      0.60      0.63        20
        REM       1.00      0.74      0.85        77

avg / total       0.93      0.92      0.92      1200

File 32: shhs2-204417 [42]
/home/sasi/git/apnea/utils.py:9: RuntimeWarning: invalid value encountered in true_divide
  cm_normalized = conf_matrix.astype('float') / conf_matrix.sum(axis=1)[:, np.newaxis]
/usr/local/lib/python3.5/dist-packages/sklearn/metrics/classification.py:1137: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples.
  'recall', 'true', average, warn_for)
[[517  27   0   1]
 [  7 605   1  10]
 [  0   0   0   0]
 [  0  11   0  21]]
[[ 0.94862385  0.04954128  0.          0.00183486]
 [ 0.01123596  0.97110754  0.00160514  0.01605136]
 [        nan         nan         nan         nan]
 [ 0.          0.34375     0.          0.65625   ]]
             precision    recall  f1-score   support

          W       0.99      0.95      0.97       545
       N1-2       0.94      0.97      0.96       623
         N3       0.00      0.00      0.00         0
        REM       0.66      0.66      0.66        32

avg / total       0.95      0.95      0.95      1200

File 33: shhs2-204421 [43]
[[342  43   0   3]
 [  7 420   1   3]
 [  0  28  59   0]
 [  5  11   0 158]]
[[ 0.8814433   0.11082474  0.          0.00773196]
 [ 0.0162413   0.97447796  0.00232019  0.00696056]
 [ 0.          0.32183908  0.67816092  0.        ]
 [ 0.02873563  0.06321839  0.          0.90804598]]
             precision    recall  f1-score   support

          W       0.97      0.88      0.92       388
       N1-2       0.84      0.97      0.90       431
         N3       0.98      0.68      0.80        87
        REM       0.96      0.91      0.93       174

avg / total       0.92      0.91      0.91      1080

File 34: shhs2-204430 [44]
[[340  12   0   2]
 [ 20 586   5  10]
 [  0   8  11   0]
 [  1   1   0 204]]
[[ 0.96045198  0.03389831  0.          0.00564972]
 [ 0.03220612  0.94363929  0.00805153  0.01610306]
 [ 0.          0.42105263  0.57894737  0.        ]
 [ 0.00485437  0.00485437  0.          0.99029126]]
             precision    recall  f1-score   support

          W       0.94      0.96      0.95       354
       N1-2       0.97      0.94      0.95       621
         N3       0.69      0.58      0.63        19
        REM       0.94      0.99      0.97       206

avg / total       0.95      0.95      0.95      1200

File 35: shhs2-200313 [45]
[[368  34   0   7]
 [  6 404   7  14]
 [  0  42  63   0]
 [  3  11   0 132]]
[[ 0.8997555   0.08312958  0.          0.01711491]
 [ 0.01392111  0.93735499  0.0162413   0.0324826 ]
 [ 0.          0.4         0.6         0.        ]
 [ 0.02054795  0.07534247  0.          0.90410959]]
             precision    recall  f1-score   support

          W       0.98      0.90      0.94       409
       N1-2       0.82      0.94      0.88       431
         N3       0.90      0.60      0.72       105
        REM       0.86      0.90      0.88       146

avg / total       0.89      0.89      0.88      1091

File 36: shhs2-200700 [46]
[[507  11   1   0]
 [  5 580  16   0]
 [  0  42 196   0]
 [  2  38   0 136]]
[[ 0.97687861  0.02119461  0.00192678  0.        ]
 [ 0.00831947  0.96505824  0.0266223   0.        ]
 [ 0.          0.17647059  0.82352941  0.        ]
 [ 0.01136364  0.21590909  0.          0.77272727]]
             precision    recall  f1-score   support

          W       0.99      0.98      0.98       519
       N1-2       0.86      0.97      0.91       601
         N3       0.92      0.82      0.87       238
        REM       1.00      0.77      0.87       176

avg / total       0.93      0.93      0.92      1534

File 37: shhs2-200939 [47]
[[656  10   0   0]
 [ 37 568   2   3]
 [  0  32  57   0]
 [  2   7   0 126]]
[[ 0.98498498  0.01501502  0.          0.        ]
 [ 0.06065574  0.93114754  0.00327869  0.00491803]
 [ 0.          0.35955056  0.64044944  0.        ]
 [ 0.01481481  0.05185185  0.          0.93333333]]
             precision    recall  f1-score   support

          W       0.94      0.98      0.96       666
       N1-2       0.92      0.93      0.93       610
         N3       0.97      0.64      0.77        89
        REM       0.98      0.93      0.95       135

avg / total       0.94      0.94      0.94      1500

File 38: shhs2-201118 [48]
[[479   6   0   2]
 [  7 468  11  23]
 [  0   7 113   0]
 [  0   3   0 174]]
[[ 0.9835729   0.01232033  0.          0.00410678]
 [ 0.01375246  0.9194499   0.021611    0.04518664]
 [ 0.          0.05833333  0.94166667  0.        ]
 [ 0.          0.01694915  0.          0.98305085]]
             precision    recall  f1-score   support

          W       0.99      0.98      0.98       487
       N1-2       0.97      0.92      0.94       509
         N3       0.91      0.94      0.93       120
        REM       0.87      0.98      0.93       177

avg / total       0.96      0.95      0.95      1293

File 39: shhs2-201326 [49]
[[651  23   0   2]
 [ 38 296   0   5]
 [  0   5   2   0]
 [  2   2   0  52]]
[[ 0.96301775  0.03402367  0.          0.00295858]
 [ 0.1120944   0.87315634  0.          0.01474926]
 [ 0.          0.71428571  0.28571429  0.        ]
 [ 0.03571429  0.03571429  0.          0.92857143]]
             precision    recall  f1-score   support

          W       0.94      0.96      0.95       676
       N1-2       0.91      0.87      0.89       339
         N3       1.00      0.29      0.44         7
        REM       0.88      0.93      0.90        56

avg / total       0.93      0.93      0.93      1078

All files:
[[20411   712     2   125]
 [  741 16917   449   480]
 [    1   796  3566     0]
 [  152   392     0  5050]]
[[  9.60517647e-01   3.35058824e-02   9.41176471e-05   5.88235294e-03]
 [  3.98665734e-02   9.10152257e-01   2.41566686e-02   2.58245010e-02]
 [  2.29200092e-04   1.82443273e-01   8.17327527e-01   0.00000000e+00]
 [  2.71719700e-02   7.00750804e-02   0.00000000e+00   9.02752950e-01]]
             precision    recall  f1-score   support

          W       0.96      0.96      0.96     21250
       N1-2       0.90      0.91      0.90     18587
         N3       0.89      0.82      0.85      4363
        REM       0.89      0.90      0.90      5594

avg / total       0.92      0.92      0.92     49794
